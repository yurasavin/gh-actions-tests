name: Set and read env
run-name: ${{ github.actor }} is testing out GitHub Actions ðŸš€

on: [push]

env:
  GKE_PROJECT: staging-tehl
  GKE_CLUSTER: primary-gke-cluster
  GKE_ZONE: us-central1
  REPO: tehl
  BACKEND_IMAGE: backend
  BACKEND_DEPLOYMENT_NAME: backend
  IMAGE_TAG:

jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout env before
        run: echo "IMAGE_TAG is ${{ env.IMAGE_TAG }}"

      - name: Set image tag env
        shell: bash
        run: echo "IMAGE_TAG=us-central1-docker.pkg.dev/${{ env.GKE_PROJECT }}/${{ env.REPO }}/${{ env.BACKEND_IMAGE }}:${{ github.sha}}" >> $IMAGE_TAG

      - name: Checkout env after
        run: echo "IMAGE_TAG is ${{ env.IMAGE_TAG }}"
