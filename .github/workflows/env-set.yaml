name: Set and read env
run-name: ${{ github.actor }} is testing out GitHub Actions ðŸš€

on: [push]

env:
  GKE_PROJECT: staging-tehl
  GKE_CLUSTER: primary-gke-cluster
  GKE_ZONE: us-central1
  REPO: tehl
  BACKEND_IMAGE: backend
  BACKEND_DEPLOYMENT_NAME: backend
  IMAGE_REGISTRY: us-central1-docker.pkg

jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    steps:
      - name: Set env
        id: backend-image-tag
        run: echo "BACKEND_IMAGE_TAG=${{ env.IMAGE_REGISTRY }}/${{ env.GKE_PROJECT }}/${{ env.REPO }}/${{ env.BACKEND_IMAGE }}:${{ github.sha}}" >> "$GITHUB_OUTPUT"

      - name: Read env
        env:
          BACKEND_IMAGE_TAG: ${{ steps.backend-image-tag.outputs.BACKEND_IMAGE_TAG }}
        run: echo "The BACKEND_IMAGE_TAG is ${{env.BACKEND_IMAGE_TAG}} or ${{ steps.backend-image-tag.outputs.BACKEND_IMAGE_TAG }}"
        # env:
        #   IMAGE_TAG: us-central1-docker.pkg.dev/${{ env.GKE_PROJECT }}/${{ env.REPO }}/${{ env.BACKEND_IMAGE }}:${{ github.sha }}

      # - name: Set image tag env
      #   shell: bash
      #   run: |
      #     tests=16
      #     echo "Tests=$tests" >> $IMAGE_TAG
      #     # echo "IMAGE_TAG=us-central1-docker.pkg.dev/${{ env.GKE_PROJECT }}/${{ env.REPO }}/${{ env.BACKEND_IMAGE }}:${{ github.sha}}" >> $IMAGE_TAG

      # - name: Checkout env after
      #   run: echo "IMAGE_TAG is ${{ env.IMAGE_TAG }}"
